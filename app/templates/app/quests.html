<!DOCTYPE html>
<html lang="en">

<head>
    {% load static %}
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Lakshya CTF</title>
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

        <link rel="stylesheet" href="{% static 'app/css/all.css' %}">

        <link rel="stylesheet" href="{% static 'app/css/bootstrap4-neon-glow.min.css' %}">

        

        <link rel='stylesheet' href="{% static 'app/css/hack.min.css' %}">
        
        <link rel="stylesheet" href="{% static 'app/css/main.css' %}">
        <link rel="stylesheet" href="{% static 'app/css/flipclock.css' %}">

    

</head>

<body>
    <div class="navbar-dark text-white">
        <div class="container">
            <nav class="navbar px-0 py-0 navbar-expand-lg navbar-dark">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
                <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                    <div class="navbar-nav">
                        <a href="index.html" class="pl-md-0 p-3 text-decoration-none text-light">
                            <h3 class="bold"><span class="color_danger">LAKSHYA</span><span class="color_white">CTF</span></h3>
                        </a>
                    </div>
                    <div class="navbar-nav ml-auto">
                        <a href="/" class="p-3 text-decoration-none text-light bold">Home</a>
                         <a href="/about" class="p-3 text-decoration-none text-light bold">About</a>
                        <a href="/instructions" class="p-3 text-decoration-none text-light bold">Instructions</a>
                        <a href="/leaderboard" class="p-3 text-decoration-none text-light bold">Leaderboard</a>
                        <a href="/logout" class="p-3 text-decoration-none text-light bold">Logout</a>
                    </div>
                </div>
            </nav>

        </div>
    </div>
    
    <div class="jumbotron bg-transparent mb-0 pt-0 radius-0">
        <div class="container">
            <div class="row">
                <div class="col-xl-12  text-center">
                    <h1 class="display-1 bold color_white content__title">QUESTS<span class="vim-caret">&nbsp;</span></h1>
                    <p class="text-grey text-spacey hackerFont lead mb-5">
                        It's time to show the world what you can do!
                    </p>
                </div>
            </div>

            <div class="row justify-content-center mb-3">
                <div class="col-md-6">
                    <div class="countdown-timer"></div>
                </div>
            </div>
            <div class="row justify-content-center mb-3">
                <div class="col-md-12 text-center">
                    <h3 id="points" style="font-size: 2rem">Score: {{ request.user.points }}</h3>
                </div>
            </div>

            <div class="row hackerFont">
                <div class="col-md-12">
                     {% for message in messages %}
                            <div class="alert alert-dismissible fade show alert-danger" role="alert">
                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">Ã—</span>
                                </button>
                                <strong>{{ message }}</strong>
                            </div>
                        {% endfor %}
                    <h4>Challenges</h4>
                </div>
                {% for challenge in challenges %}
                <div class="col-md-6 mb-3">
                    <div class="card category_{{ challenge.questionType }}">
                        <div class="card-header" data-target="#problem_id_{{ challenge.questionId }}" data-toggle="collapse" aria-expanded="false" aria-controls="problem_id_{{ challenge.questionId }}">
                            {{ challenge.questionTitle }}&nbsp;<span class="badge align-self-end">{{ challenge.questionPoints }} points</span>
                        </div>
                        <div id="problem_id_{{ challenge.questionId }}" class="collapse card-body">
                            <blockquote class="card-blockquote">
                                <div style="display: flex;">
                                    <h6 class="solvers">Solvers: <span class="solver_num">{{ challenge.questionSolvers }}</span> &nbsp;<span class="color_danger">Difficulty:</span></h6>
                                    <div class="pl-2"><canvas style="width:80px;height:20px" id="problem_id_question{{ challenge.questionId}}_chart"></canvas></div>
                                </div>
                                <p> {{ challenge.questionDescription }}
                                </p>
                                {% if challenge.questionData|safe %}
                                <a href="{{ challenge.questionData.url }}" class="btn btn-outline-secondary btn-shadow"><span class="fa fa-download mr-2"></span>Download</a>
                                {% endif %}
                                <a onclick="getHint({{challenge.questionId}})" data-toggle="modal" data-target="#hint" class="btn btn-outline-secondary btn-shadow"><span class="far fa-lightbulb mr-2"></span>Hint</a>

                                <form method="POST">
                                    {% csrf_token  %}
                                <div class="input-group mt-3">
                                    <div class="ht-tm-element custom-control custom-radio">
                                        <input type="radio" id="radio1_{{ challenge.questionId }}" name="radio_btn" class="custom-control-input" value="EA" required>
                                        <label class="custom-control-label" for="radio1_{{ challenge.questionId }}">Easy</label>
                                    </div>
                                    <div class="ht-tm-element custom-control custom-radio">
                                        <input type="radio" id="radio2_{{ challenge.questionId }}" name="radio_btn" class="custom-control-input" value="ME">
                                        <label class="custom-control-label" for="radio2_{{ challenge.questionId }}">Medium</label>
                                    </div>
                                    <div class="ht-tm-element custom-control custom-radio">
                                        <input type="radio" id="radio3_{{ challenge.questionId }}" name="radio_btn" class="custom-control-input" value="HA">
                                        <label class="custom-control-label" for="radio3_{{ challenge.questionId }}">Hard</label>
                                    </div>
                                </div>
                                <div class="input-group mt-3">
                                    
                                    <input type="text" id="flag" name="flag" class="form-control" placeholder="Enter Flag" aria-label="Enter Flag" aria-describedby="basic-addon2" required>
                                    <input type="hidden" id="qid" name="qid" value="{{challenge.questionId }}" required>
                                    <div class="input-group-append">
                                        <input type="submit" id="submit_p2" class="btn btn-outline-secondary" value="Go!">
                                    </div>
                                    </form>
                                    
                                </div>
                            </blockquote>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="row hackerFont justify-content-center mt-5">
                <div class="col-md-12">
                    <h4>Machines</h4>
                </div>
                {% for machine in machines %}
                <div class="col-md-12 mb-3">
                    <div class="card category_machine">
                        <a href="/machine/{{ machine.machineId }}" class="color_white">
                            <div class="card-header">
                                {{ machine.machineTitle }} <span class=" ml-4 badge align-self-end">{{ machine.machinePoints }} points</span>
                                <div class="pl-4 machine" style="display: inline-flex;">
                                    {{ machine.machineIp }}
                                    <h4 class=" pl-4 pt-1 solvers">Solvers: <span class="solver_num">{{ machine.machineSolvers }}</span> &nbsp;<span class="color_danger">Difficulty:</span></h4>
                                    <div class="pl-2"><canvas style="width:80px;height:40px" id="problem_id_machine{{ machine.machineId }}_chart"></canvas></div>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                {% endfor %}
            <div class="row hackerFont justify-content-center mt-5">
                <div class="col-md-12">
                    Chart Difficulties: 
                    <span style="color:#17b06b">Easy,</span>
                    <span style="color:#ffce56">Medium,</span>
                    <span style="color:#ef121b">Hard</span>
                    <br><br>Challenge Types:
                    <span class="p-1" style="background-color:#ef121b94">Web</span>
                    <span class="p-1" style="background-color:#17b06b94">Reversing</span>
                    <span class="p-1" style="background-color:#f9751594">Steganography</span>
                    <span class="p-1" style="background-color:#36a2eb94">Pwning</span>
                    <span class="p-1" style="background-color:#9966FF94">Cryptography</span>
                    <span class="p-1" style="background-color:#ffce5694">Miscellanous</span>
                </div>
            </div>
        </div>
        <div class="modal fade" id="hint" tabindex="-1" role="dialog" aria-labelledby="hint label" style="display: none;" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-body" id="hint-content">
                        {{ hint }}
                    </div>
                </div>
            </div>
        </div>
        <script src="{% static 'app/js/jquery-3.4.1.min.js' %}"></script>
        <script src="{% static 'app/js/popper.min.js' %}"></script>
        <script src="{% static 'app/js/bootstrap.min.js' %}"></script>
        
        <script src="{% static 'app/js/moment.min.js' %}"></script>
        <script src="{% static 'app/js/chart.min.js' %}"></script>
        <script src="{% static 'app/js/flipclock.js' %}"></script>
        <script src="{% static 'app/js/preloader.js' %}"></script>
        <script src="{% static 'app/js/questionLogic.js' %}"></script>
        <script>
           
            window.onload = function() {

                 {% for challenge in challenges %} 


                    function getBarChartData() {
                        return barChartData = {
                            labels: ['Easy','Medium', 'Hard'],
                            datasets: [{
                                label: 'Dataset 1',
                                backgroundColor: [
                                    '#17b06b','#ffce56', '#ef121b'
                                ],
                                borderColor: [
                                    '#17b06b','#ffce56','#ef121b'
                                ],
                                borderWidth: 1,
                                data: [{{ challenge.easyRating }}, {{ challenge.mediumRating }}, {{ challenge.hardRating }}]
                            }]

                        };
                    }

                  var ctx = document.getElementById('problem_id_question' + '{{challenge.questionId}}' + '_chart').getContext('2d');
                    window.myBar = new Chart(ctx, {
                        type: 'bar',
                        data: getBarChartData(),
                        options: {
                            tooltips: {
                                enabled: false,
                            },
                            responsive: false,
                            legend: {
                                display: false,
                            },
                            scales: {
                                yAxes: [{
                                    display: false,
                                    ticks: {
                                        beginAtZero: true,
                                    },
                                }],
                                xAxes: [{
                                    display: false
                                }]
                            }
                        }
                    });
                    myBar.canvas.parentNode.style.width = '80px';
                    myBar.canvas.parentNode.style.height = '20px';
                {% endfor %}
                
                {% for machine in machines %} 


                    function getBarChartData() {
                        return barChartData = {
                            labels: ['Easy','Medium', 'Hard'],
                            datasets: [{
                                label: 'Dataset 1',
                                backgroundColor: [
                                    '#17b06b','#ffce56', '#ef121b'
                                ],
                                borderColor: [
                                    '#17b06b','#ffce56','#ef121b'
                                ],
                                borderWidth: 1,
                                data: [{{ machine.easyRating }}, {{ machine.mediumRating }}, {{ machine.hardRating }}]
                            }]

                        };
                    }

                  var ctx = document.getElementById('problem_id_machine' + '{{machine.machineId}}' + '_chart').getContext('2d');
                    window.myBar = new Chart(ctx, {
                        type: 'bar',
                        data: getBarChartData(),
                        options: {
                            tooltips: {
                                enabled: false,
                            },
                            responsive: false,
                            legend: {
                                display: false,
                            },
                            scales: {
                                yAxes: [{
                                    display: false,
                                    ticks: {
                                        beginAtZero: true,
                                    },
                                }],
                                xAxes: [{
                                    display: false
                                }]
                            }
                        }
                    });
                    myBar.canvas.parentNode.style.width = '80px';
                    myBar.canvas.parentNode.style.height = '20px';
                {% endfor %}
            };
        </script>

        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->

       

</body>

</html>